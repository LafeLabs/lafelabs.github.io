<!DOCTYPE HTML>
<html>
<head>
<title>General Test File</title>
<script id = "bytecodeScript">
/*
060:0313,0304,0336,0336,0330,0333,0330,0330,0343,0331,0331,0334,0334,0343,0332,0334,0334,0337,0342,0332,0342,0336,0331,0337,0337,0350,0350,0335,0350,0350,0335,0350,0334,0311,0337,0310,0336,0342,0337,0311,0336,0335,0351,0334,0351,0351,0334,0304,0333,0336,0336,0332,0337,0337
061:0304,0313,0335,0336,0342,0336,0330,0334,0337,0337,0342,0330,0334,0350,0334,0336,0336,0310,0337,0342,0336,0313,0335,0351,0335,0337,0331,0331,0333,0336,0336,0332,0337,0337,0337
062:0304,0313,0335,0336,0342,0336,0330,0334,0330,0330,0330,0343,0331,0331,0331,0332,0337,0337,0306,0350,0335,0342,0334,0304,0333,0336,0336,0332,0337,0337
063:0313,0304,0336,0336,0330,0333,0335,0343,0332,0332,0343,0334,0350,0343,0331,0331,0335,0335,0335,0335,0343,0330,0334,0334,0334,0334,0304,0333,0336,0333,0337,0337,0337
064:0333,0336,0332,0337,0342,0336,0330,0334,0342,0330,0335,0350,0335,0342,0334,0351,0331,0337,0336,0333,0336,0333,0337,0337
065:0313,0304,0336,0336,0330,0333,0335,0343,0335,0335,0350,0334,0350,0334,0343,0334,0351,0351,0331,0331,0331,0334,0342,0335,0335,0342,0330,0334,0342,0330,0342,0330,0334,0342,0330,0333,0333,0334,0333,0336,0333,0337,0337,0337
066:0304,0313,0336,0336,0332,0337,0337,0333,0336,0336,0332,0332,0330,0341,0332,0350,0350,0335,0337,0337,0342,0336,0336,0334,0351,0351,0333,0333,0333,0331,0336,0332,0337,0337,0337
067:0336,0332,0336,0336,0333,0337,0337,0337,0333,0336,0332,0350,0350,0335,0337,0342,0330,0334,0334,0334,0334,0334,0336,0342,0351,0351,0335,0350,0350,0335,0337,0331,0334,0351,0351,0336,0333,0337
070:0304,0313,0336,0336,0336,0332,0332,0337,0337,0337,0333,0336,0332,0336,0330,0341,0330,0330,0341,0333,0333,0331,0331,0331,0336,0332,0337,0337,0337
071:0304,0313,0336,0336,0332,0337,0337,0333,0336,0336,0332,0337,0337,0342,0336,0330,0336,0330,0332,0341,0333,0333,0330,0337,0337,0331
072:0333,0336,0332,0330,0336,0336,0336,0341,0331,0331,0331,0331,0331,0331,0331,0341,0333,0333,0333,0333,0331,0337,0337,0337,0337
073:0333,0336,0332,0330,0336,0336,0336,0341,0331,0331,0331,0331,0334,0334,0337,0337,0350,0335,0342,0335,0351,0335,0331,0333,0337,0337
074:0333,0336,0330,0332,0350,0335,0342,0335,0335,0342,0335,0351,0330,0335,0335,0333,0337
0200:0304,0342,0330,0334,0342,0330,0334,0342,0330,0334,0342,0330,0334
0201:0344,0330
0202:0362,0304,0310,0350,0335,0337,0201,0335,0336,0201,0335,0335,0335,0337,0201,0335,0336,0201,0335,0335,0304,0333,0363,
0203:0320,0202,0321,0202
0204:0203,0203,0203,0203,0203,0203,0203,0203
0205:0322,0202,0323,0202
0206:0205,0205,0205,0205,0205,0205,0205,0205
0210:0320,0362,0311,0201,0335,0336,0201,0335,0337,0201,0335,0336,0201,0363
0400:0300,0330,0332,0332,0332,0336,0332,0330,0204,
0401:0300,0331,0332,0332,0332,0336,0332,0204
0402:0300,0332,0332,0332,0336,0332,0206
0403:0300,0331,0337,0210,0333,0336,0210,0333,0336,0210,0333,0336,0210,0333,0336,0210,0333,0336,0210
01300:0333,0200,0336,0330,0332,0340,0350,0335,0336,0330,0342,0331,0331,0331,0342,0330,0330,0335,0335,0331,0331,0342,0330,0330,0330,0342,0331,0334,0334,0334,0351,0331,0331,0333,0333,0337,0337
01304:0333,0200,0336,0330,0332,0341,0342,0335,0342,0335,0342,0335,0342,0350,0335,0351,0336,0336,0330,0330,0341,0331,0331,0335,0330,0330,0341,0331,0331,0335,0330,0330,0341,0331,0331,0335,0330,0330,0341,0331,0331,0350,0334,0351,0337,0337,0330,0335,0335,0333,0337
01305:0333,0200,0336,0330,0332,0305,0342,0335,0342,0335,0342,0335,0342,0335,0342,0335,0341,0350,0335,0351,0336,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0350,0335,0304,0337,0331,0333,0337
01306:0333,0200,0336,0330,0332,0306,0342,0335,0342,0335,0342,0335,0342,0335,0342,0335,0341,0350,0335,0351,0336,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0335,0330,0336,0336,0341,0337,0337,0331,0350,0335,0335,0335,0337,0342,0334,0336,0330,0336,0336,0341,0337,0337,0331,0304,0335,0337,0331,0333,0337
01310:0333,0200,0336,0332,0350,0335,0310,0337,0342,0330,0334,0334,0342,0330,0334,0334,0342,0330,0334,0334,0342,0330,0334,0334,0334,0351,0336,0313,0333,0337
01311:0335,0305,0342,0334,0311,0337,0342,0336,0335,0330,0334,0350,0334,0337,0342,0334,0334,0304,0336,0313,0335,0200,0334,0305,0350,0335,0342,0330,0335,0335,0335,0311,0336,0342,0330,0334,0334,0334,0336,0342,0335,0335,0335,0337,0331,0334,0334,0334,0337,0331,0334,0313,0304,0335
01312:0333,0200,0352,0334,0342,0330,0334,0334,0334,0334,0342,0334,0312,0337,0313,0336,0342,0330,0334,0334,0334,0334,0336,0342,0334,0334,0304,0312,0336,0313,0337,0333,0337
01313:0333,0200,0336,0336,0332,0332,0330,0342,0334,0342,0330,0335,0342,0330,0335,0342,0330,0342,0330,0335,0342,0330,0335,0342,0335,0331,0333,0337,0337
01314:0333,0200,0314,0336,0332,0332,0330,0200,0333,0200,0333,0200,0331,0337,0313
01315:0333,0313,0200,0336,0330,0332,0341,0335,0342,0334,0334,0342,0334,0334,0330,0334,0331,0337
01316:0333,0200,0336,0336,0330,0332,0332,0332,0336,0341,0330,0330,0330,0330,0341,0333,0333,0331,0331,0341,0333,0333,0330,0330,0341,0331,0331,0331,0331,0341,0333,0333,0331,0331,0337,0337,0337,
01317:0333,0200,0336,0336,0330,0332,0336,0330,0333,0337,0342,0336,0330,0334,0337,0337,0342,0330,0336,0342,0330,0335,0336,0342,0331,0342,0332,0330,0337,0337,0333,0333,0331,0337
01321:0333,0200,0336,0336,0330,0332,0332,0337,0321,0342,0321,0332,0320,0336,0331,0337,0337,0333
01322:0333,0200,0336,0336,0330,0332,0332,0337,0322,0342,0321,0332,0320,0336,0331,0337,0337,0333
01330:0333,0200,0313,0336,0336,0330,0332,0336,0332,0337,0342,0334,0342,0330,0335,0342,0330,0334,0336,0342,0330,0335,0350,0335,0337,0310,0337,0342,0330,0335,0335,0342,0330,0335,0335,0335,0336,0313,0336,0342,0330,0351,0335,0331,0331,0331,0331,0333,0333,0333,0337,0337,0337
01331:0333,0200,0335,0335,0333,0331,0313,0336,0336,0330,0332,0336,0332,0337,0342,0334,0342,0330,0335,0342,0330,0334,0336,0342,0330,0335,0350,0335,0337,0310,0337,0342,0330,0335,0335,0342,0330,0335,0335,0335,0336,0313,0336,0342,0330,0351,0335,0331,0331,0331,0331,0333,0333,0333,0337,0337,0337,0332,0335,0335,0331
01332:0333,0200,0334,0333,0313,0336,0336,0330,0332,0336,0332,0337,0342,0334,0342,0330,0335,0342,0330,0334,0336,0342,0330,0335,0350,0335,0337,0310,0337,0342,0330,0335,0335,0342,0330,0335,0335,0335,0336,0313,0336,0342,0330,0351,0335,0331,0331,0331,0331,0333,0333,0333,0337,0337,0337,0335,0331
01333:0333,0200,0335,0331,0313,0336,0336,0330,0332,0336,0332,0337,0342,0334,0342,0330,0335,0342,0330,0334,0336,0342,0330,0335,0350,0335,0337,0310,0337,0342,0330,0335,0335,0342,0330,0335,0335,0335,0336,0313,0336,0342,0330,0351,0335,0331,0331,0331,0331,0333,0333,0333,0337,0337,0337,0330,0334
01334:0333,0200,0336,0330,0332,0336,0350,0343,0334,0334,0343,0334,0334,0343,0334,0342,0335,0330,0336,0330,0334,0334,0334,0337,0342,0334,0351,0336,0331,0337,0337,0333,0337
01335:0333,0200,0336,0330,0332,0336,0350,0343,0334,0334,0343,0334,0334,0343,0334,0334,0334,0342,0334,0330,0336,0330,0335,0335,0335,0337,0342,0336,0335,0331,0351,0337,0337,0332,0335,0335,0337,0331
01336:0333,0200,0336,0330,0334,0336,0330,0337,0342,0336,0331,0335,0337,0331,0337
01337:0333,0200,0336,0330,0332,0336,0342,0334,0342,0334,0342,0334,0342,0330,0330,0334,0337,0331,0337
01340:0333,0200,0336,0330,0332,0340,0333,0331,0337
01341:0333,0200,0336,0330,0332,0341,0340,0333,0331,0337
01342:0333,0200,0336,0330,0332,0334,0336,0342,0330,0340,0331,0335,0335,0342,0330,0340,0333,0333,0330,0334,0337,0337
01343:0333,0200,0336,0330,0332,0350,0343,0335,0342,0334,0334,0342,0335,0340,0351,0331,0333,0337
01344:0304,0313,0333,0200,0336,0332,0344,0333,0337
01345:0304,0313,0333,0200,0336,0332,0345,0333,0337
01346:0304,0313,0333,0200,0336,0332,0346,0333,0337
01347:0304,0313,0333,0200,0336,0332,0347,0333,0337
01350:0333,0200,0336,0330,0332,0350,0335,0342,0335,0335,0342,0334,0336,0336,0342,0330,0330,0342,0331,0331,0351,0337,0337,0334,0333,0331,0337
01351:0333,0200,0336,0332,0330,0350,0335,0336,0336,0342,0330,0330,0342,0330,0330,0342,0331,0331,0331,0331,0335,0337,0337,0342,0335,0342,0334,0351,0333,0330,0334,0337
01352:0333,0200,0336,0330,0332,0335,0350,0352,0334,0334,0334,0342,0335,0335,0336,0336,0342,0330,0330,0342,0331,0331,0335,0335,0342,0330,0330,0342,0331,0331,0335,0335,0337,0337,0342,0335,0335,0335,0351,0353,0330,0334,0334,0333,0337
01353:0333,0200,0336,0330,0332,0335,0350,0352,0334,0342,0335,0335,0342,0335,0335,0336,0336,0342,0330,0330,0342,0331,0331,0334,0334,0334,0334,0334,0334,0342,0330,0330,0342,0331,0331,0335,0335,0335,0351,0353,0337,0337,0333,0330,0334,0337
01362:0333,0200,0336,0336,0330,0332,0332,0332,0340,0342,0330,0342,0330,0335,0342,0330,0342,0330,0350,0334,0334,0334,0342,0334,0334,0335,0334,0342,0334,0304,0330,0330,0330,0334,0334,0333,0337,0337,
01363:0304,0313,0333,0200,0336,0332,0330,0336,0330,0332,0335,0342,0330,0342,0330,0335,0342,0330,0342,0330,0334,0350,0334,0342,0334,0334,0342,0340,0335,0304,0331,0333,0337,0337
01200:0333,0200,0336,0336,0330,0332,0337,0200,0336,0331,0333,0337,0337
01201:0304,0313,0333,0200,0336,0336,0330,0330,0332,0332,0332,0335,0336,0337,0337,0342,0330,0335,0350,0335,0336,0336,0342,0335,0335,0342,0335,0304,0337,0331,0331,0333,0337,0337
01020:0304,0333,0200,0336,0330,0332,0336,0336,0332,0337,0200,0333,0333,0200,0332,0332,0336,0330,0335,0337,0342,0330,0350,0335,0335,0351,0333,0350,0336,0334,0342,0334,0334,0342,0337,0335,0351,0333,0336,0333,0331,0337,0337,0331,0337,0304,0336,0330,0330,0336,0330,0334,0331,0337,0337
01021:0304,0333,0200,0336,0330,0332,0336,0336,0332,0337,0200,0333,0333,0200,0332,0332,0336,0330,0335,0337,0342,0330,0350,0335,0335,0335,0336,0342,0335,0335,0342,0337,0335,0351,0333,0336,0333,0331,0337,0337,0331,0337,0304
01022:0333,0200,0336,0336,0330,0330,0332,0332,0332,0336,0336,0333,0337,0337,0336,0330,0336,0333,0337,0337,0200,0333,0200,0333,0200,0331,0331,0332,0332,0200,0333,0200,0333,0200,0336,0333,0331,0337,0337,0332,0330,0336,0336,0331,0337,0342,0330,0335,0350,0335,0336,0342,0335,0335,0342,0337,0335,0335,0335,0351,0331,0331,0331,0333,0333,0336,0330,0337,0337,0337
01023:0333,0200,0336,0336,0330,0330,0332,0332,0332,0336,0336,0333,0337,0337,0336,0330,0336,0333,0337,0337,0200,0333,0200,0333,0200,0331,0331,0332,0332,0200,0333,0200,0333,0200,0336,0333,0331,0337,0337,0332,0330,0336,0336,0331,0337,0335,0335,0331,0342,0330,0335,0350,0335,0336,0342,0335,0335,0342,0337,0335,0335,0335,0351,0331,0331,0331,0333,0333,0336,0330,0337,0337,0337,0335,0335,0331,0333
01024:0333,0200,0336,0336,0330,0332,0337,0200,0336,0336,0330,0332,0337,0200,0336,0336,0330,0332,0337,0200,0333,0333,0333,0331,0331,0331,0336,0331,0333,0337,0337,0337,0337
01025:0333,0200,0336,0336,0330,0332,0337,0336,0336,0330,0332,0337,0200,0336,0336,0330,0332,0337,0200,0333,0333,0333,0331,0331,0331,0336,0331,0333,0337,0337,0337,0337
01026:0333,0200,0336,0330,0332,0336,0336,0333,0331,0337,0200,0306,0335,0342,0332,0342,0330,0335,0335,0342,0335,0335,0335,0335,0331,0334,0304,0332,0306,0335,0342,0330,0350,0335,0342,0334,0331,0335,0304,0334,0331,0332,0335,0336,0332,0337,0342,0330,0350,0335,0335,0335,0336,0342,0335,0335,0342,0335,0304,0331,0331,0331,0331,0333,0333,0333,0333,0333,0337,0337,0337
01027:0333,0200,0336,0330,0332,0336,0336,0333,0331,0337,0332,0200,0306,0335,0342,0332,0342,0330,0335,0335,0342,0335,0335,0335,0335,0331,0334,0304,0332,0306,0335,0342,0330,0350,0335,0342,0334,0331,0335,0304,0334,0331,0333,0333,0330,0335,0342,0330,0350,0335,0335,0335,0336,0342,0335,0335,0342,0335,0304,0331,0331,0331,0331,0331,0333,0337,0337,0337
01010:0333,0200,0350,0334,0310,0337,0342,0336,0332,0335,0335,0337,0342,0336,0333,0334,0351,0313
01030:0333,0200,0336,0332,0337,0350,0350,0350,0342,0335,0342,0335,0342,0335,0342,0335,0342,0335,0342,0334,0334,0334,0334,0334,0334,0342,0334,0342,0334,0342,0334,0342,0334,0334,0342,0335,0335,0335,0335,0335,0335,0335,0335,0335,0335,0335,0335,0342,0334,0334,0334,0334,0334,0334,0304,0343,0336,0333,0337
0400:0300,0332,0313,0337,0336,0332,01220,0330,0335,0342,0332,0336,0333,0337,0342,0313,0330,0330,0334,0331,0337,01316,01313,
0210:0344,0330,
0211:0362,0210,0335,0210,0335,0210,0335,0210,0363,
01210:0304,0313,0333,0200,0336,0336,0330,0330,0332,0332,0332,0335,0336,0337,0337,0342,0330,0335,0350,0335,0336,0336,0342,0335,0335,0342,0335,0304,0337,0331,0331,0333,0337,0337,
01211:0333,0200,0336,0336,0330,0332,0332,0332,0337,0211,0335,0333,0336,0333,0331,0337,0337
01220:0333,0200,0336,0336,0330,0332,0332,0332,0310,0337,0342,0342,0336,0333,0336,0330,0343,0335,0335,0343,0335,0335,0333,0333,0350,0335,0342,0335,0335,0342,0335,0335,0342,0335,0335,0342,0335,0304,0331,0331,0331,0331,0333,0333,0337,0337,0337,
0220:0316,0336,0313,0336,0334,0362,0210,0210,0210,0210,0335,0210,0210,0210,0210,0210,0210,0210,0210,0335,0210,0210,0210,0210,0210,0210,0210,0210,0335,0210,0210,0210,0210,0210,0210,0210,0210,0335,0210,0210,0210,0210,0363,0335,0330,0330,0330,0330,0330,0330,0330,0330,0337,0316,0337,0313,
0401:0220
0221:0316,0336,0313,0336,0330,0330,0330,0330,0330,0330,0330,0337,0316,0337,0313,
01221:0313,0333,0200,0336,0336,0330,0332,0332,0350,0350,0335,0337,0342,0330,0334,0334,0334,0334,0334,0336,0342,0335,0335,0335,0335,0335,0337,0331,0334,0304,0336,0336,0331,0331,0333,0333,0333,0333,0337,0337,0337,
0222:0220,0221,0220,
0250:0336,0336,0330,0362,0210,0210,0335,0210,0210,0210,0210,0334,0210,0335,0350,0335,0337,0310,0337,0210,0335,0335,0210,0335,0335,0335,0336,0313,0336,0210,0334,0334,0304,0210,0210,0210,0210,0335,0363,0331,0337,0337,
01250:0333,0200,0336,0330,0332,0336,0331,0332,0337,0250,0336,0331,0333,0333,0333,0337,0337,
0400:0336,0332,0335,0334,0331,0250,0333,0333,0306,0334,0334,0304,0333,0331,0304,0250,0333,0333,0306,0334,0334,0304,0331,0333,0250,0333,0333,0333,0333,0333,0300,0331,0332,0332,0332,0336,0336,0337,0331,0332,0204,0330,0330,0300,0330,0332,0332,0332,0332,0336,0204,0332,
0202:0304,0313,0350,0335,0336,0336,0342,0333,0342,0333,0342,0333,0342,0333,0334,0304,0337,0337,
01202:0202,0200,
01344:0333,0200,0336,0330,0332,0336,0332,0340,0335,0337,0342,0330,0340,0334,0332,0336,0331,0332,0331,0337,0337,0202,
01203:0304,0313,0333,0200,0336,0336,0330,0330,0332,0332,0332,0335,0336,0337,0337,0342,0330,0335,0350,0335,0336,0336,0342,0335,0335,0342,0335,0304,0337,0331,0331,0333,0337,0337,0332,0202
0203:0344,0330,
01204:0333,0200,0336,0330,0332,0336,0331,0332,0337,070,0335,0336,0332,0332,0331,0331,0336,0332,0330,0337,0337,0342,0330,0335,0350,0335,0336,0336,0342,0335,0335,0342,0335,0304,0333,0333,0333,0336,0332,0330,0330,0337,0337,0337,0337,0331,
0205:0203,0203,0203,0203,
01205:0333,0200,0336,0330,0332,0336,0331,0332,0337,064,0335,0336,0332,0332,0331,0331,0336,0332,0330,0337,0337,0342,0330,0335,0350,0335,0336,0336,0342,0335,0335,0342,0335,0304,0333,0333,0333,0336,0332,0330,0330,0337,0337,0337,0337,0331,

*/
</script>
<script>

	currentTable = []; 
	for(var index = 0;index < 01777;index ++){
		currentTable.push("");
	}  
	var inputbytecode = document.getElementById("bytecodeScript").text;
	console.log(inputbytecode);
	
	var bytecodearray = inputbytecode.split("\n");

	for(var index = 0;index < bytecodearray.length;index++){
		if(bytecodearray[index].includes(":")){
			var localBytecode = bytecodearray[index].split(":");
			var localAddress = parseInt(localBytecode[0],8);
			currentTable[localAddress] = localBytecode[1];
		}
	}

	currentAddress = 0202;
	currentGlyph = currentTable[currentAddress];
	currentGlyphArray = currentGlyph.split(",");
	cursorPosition = currentGlyphArray.length;
	phi = 0.5*(Math.sqrt(5) + 1);
	unit = 100;
	scaleFactor = 2;
	side = unit;
	thetaStep = Math.PI/2;
	theta0 = -Math.PI/2; 
	theta = theta0;

	x0 = 300;
	y0 = 200;
	x = x0;
	y = y0;

	cursor = {
		x:x,
		y:y,
		theta:theta,
		thetaStep:thetaStep,
		side:side,
		glyph:"0362,0344,0363,0336,0330,0340,0331,0337,0337,0330,0340,0331,0336,0334,0362,0344,0363,0335,0335,0362,0344,0363"
	}


</script>
</head>
<body>
<div class = "atom" id = "masterRoot"></div>
<div id = "glyphTableEditor" class = "atom" style = "display:block">
	<canvas style = "display:none;" id = "invisibleCanvas"></canvas>
	<div class = "atom">
		<canvas width = "600" height = "300" id = "plotCanvas"></canvas>
	</div>
	<div id = "spellDiv">
		<canvas width = "3000" height = "30" id = "spellCanvas" style = "border:solid;float:left;"></canvas>
		<input size = "6" id = "addr" style = "float:left;" onchange = "updateAddr();"></input>
		<input style = "float:left;" size = "428" id = "glyphBytecode" onchange = "updateGlyph()"></input>
	</div>
	<div class = "atom" style = "width:610px;height:auto" id = "controlPad">
		<div style = "width:95px;height:100px;float:left" id = "directionPad"></div>
		<div style = "width:210px;height:30px;float:left" id = "anglePad"></div>
		<div style = "width:180px;height:30px;float:left" id = "scalePad"></div>
		<div style = "width:125px;height:100px;float:right;" id = "rootPad"></div>
		<div style = "width:300px;height:100px;float:left;" id = "drawPad"></div>
		<input style = "float:left;margin:0px" size = "80" id = "drawGlyphGlyph" onchange = "updateDrawGlyphs();"></input>
	</div>
	<p>
	<div class = "atom">
		<textarea id = "mainTextArea"  cols = "84" rows = "12">
		</textarea>
	</div>
</div>


<script>

currentNode = document.getElementById("directionPad");
//buildPanel([0334,0330,0335,0332,0300,0333,0336,0331,0337]);
buildPanel("0334,0330,0335,0332,0300,0333,0336,0331,0337");

currentNode = document.getElementById("anglePad");
buildPanel("0304,0305,0306,0350,0351,0352,0353");

currentNode = document.getElementById("scalePad");
buildPanel("0310,0311,0312,0313,0314,0316");

currentNode = document.getElementById("rootPad");
buildPanel("020,010,021,022,023,024,025,026,027");


currentNode = document.getElementById("drawPad");
drawGlyphsGlyph = "0340,0341,0342,0344,0362,0363,0200,0203,0211,0202,0204";
document.getElementById("drawGlyphGlyph").value = drawGlyphsGlyph;
buildPanel(drawGlyphsGlyph);


ctx = document.getElementById("plotCanvas").getContext("2d");
currentGlyph = currentTable[currentAddress];
redraw();


currentNode = document.getElementById("masterRoot");
appendGlyphButton(030);



function buildPanel(glyphsGlyph){
	var glyphsGlyphArray = glyphsGlyph.split(",");
	var buttonArray = [];
	for(var index = 0;index < glyphsGlyphArray.length;index++){
		buttonArray.push(parseInt(glyphsGlyphArray[index],8));
	}
	for(var index = 0;index < buttonArray.length;index++){
		appendGlyphButton(buttonArray[index]);
	}
}

function updateAddr(){
	currentAddress = parseInt(document.getElementById("addr").value,8);
	currentGlyph = currentTable[currentAddress];
	currentGlyphArray = currentGlyph.split(",");
	cursorPosition = currentGlyphArray.length;
	redraw();
}

function updateGlyph(){
	currentGlyph = document.getElementById("glyphBytecode").value;
	currentGlyph = commaCleaner(currentGlyph);
	currentTable[currentAddress] = currentGlyph;
	currentGlyphArray = currentGlyph.split(",");
	cursorPosition = currentGlyphArray.length;
	redraw();	
}

function updateDrawGlyphs(){
	currentNode = document.getElementById("drawPad");
	while (currentNode.hasChildNodes()) {
		currentNode.removeChild(currentNode.childNodes[0]);
	}
	drawGlyphsGlyph = document.getElementById("drawGlyphGlyph").value;
	buildPanel(drawGlyphsGlyph);
}


function redraw(){
	x0 = 300;
	y0 = 150;
	unit = 100;
	//draw the glyph:
	ctx = document.getElementById("plotCanvas").getContext("2d");
	ctx.clearRect(0,0,600,300);
	//draw current glyph:
	doTheThing(0300);

	drawGlyph(currentGlyph);
	//draw the cursor:
	ctx = document.getElementById("invisibleCanvas").getContext("2d");
	getCursor();
	ctx = document.getElementById("plotCanvas").getContext("2d");
	drawGlyph(cursor.glyph);

	//spell:
	ctx = document.getElementById("spellCanvas").getContext("2d");
	ctx.clearRect(0,0,3000,40);
	unit = 20;
	x0 = 5;
	y0 = 25;
	doTheThing(0300);
	spellGlyph(currentGlyph);
	
	document.getElementById("addr").value = "0" + currentAddress.toString(8);
	document.getElementById("glyphBytecode").value = currentGlyph;
	
}


function appendGlyphButton(localCommand){
	glyphButtonSize = 30;
	var newCanvas = document.createElement("CANVAS");		
	newCanvas.width = glyphButtonSize;
	newCanvas.height = glyphButtonSize;
	newCanvas.className = "glyphButtons";
	ctx = newCanvas.getContext("2d");
	ctx.fillStyle="white";
	ctx.fillRect(5, 5, glyphButtonSize-10, glyphButtonSize-10);
	ctx.fillStyle="black";
	doTheThing(0300);			
	x = 5;
	y = glyphButtonSize-5;
	side = glyphButtonSize-10;
	doTheThing(localCommand + 01000);
	if(localCommand < 040){
		newCanvas.onclick = function(){
			localRoot(localCommand);
		}	
	}
	if(localCommand >= 040){
		newCanvas.onclick = function(){
			cursorAction(localCommand);	
			redraw();	
		}
	}
	currentNode.appendChild(newCanvas);
}


function cursorAction(localCommand){
	currentGlyphArray = currentGlyph.split(",");
	if(cursorPosition > currentGlyphArray.length){
		cursorPosition = currentGlyphArray.length;
	}
	currentGlyph = "";
	doTheThing(0300);
	
	for(var index = 0;index < cursorPosition;index++){
		currentGlyph += currentGlyphArray[index] + ",";	
		var localAction = parseInt(currentGlyphArray[index],8);
		if( !((localAction >= 0340) && (localAction < 0344)) ){
			doTheThing(localAction);
		}
	}
	if(localCommand != undefined){
		if( !((localCommand >= 0340) && (localCommand < 0344)) ){
			doTheThing(localCommand);
		}
	}
	cursor.x = x;
	cursor.y = y;
	cursor.theta = theta;
	cursor.thetaStep = thetaStep;
	cursor.side = side;
	if(localCommand != undefined){
		currentGlyph += "0" + localCommand.toString(8) + ",";
	}	
	for(var index = cursorPosition;index < currentGlyphArray.length;index++){
		currentGlyph += currentGlyphArray[index] + ",";		
	}
	cursorPosition++;	
	currentGlyph = commaCleaner(currentGlyph);
}

function getCursor(){

	currentGlyphArray = currentGlyph.split(",");
	var foo = "";
	doTheThing(0300);
	for(var index = 0;index < cursorPosition;index++){
		foo += currentGlyphArray[index] + ",";	
		var localAction = parseInt(currentGlyphArray[index],8);
		doTheThing(localAction);
	}
	cursor.x = x;
	cursor.y = y;
	cursor.theta = theta;
	cursor.thetaStep = thetaStep;
	cursor.side = side;

}

function commaCleaner(dirtyGlyph){ //remove extra commas from glyph
	var dirtyArray = dirtyGlyph.split(",");
	var cleanGlyph = "";
	for(var index = 0;index < dirtyArray.length;index++){
		if(dirtyArray[index] != ""){
			cleanGlyph += dirtyArray[index] + ",";
		}
	}
	return cleanGlyph;
}

function drawGlyph(localString){
	var tempArray = localString.split(',');
	for(var index = 0;index < tempArray.length;index++){
		doTheThing(parseInt(tempArray[index],8));
	}
}
function spellGlyph(localString){
	var tempArray = localString.split(',');
	for(var index = 0;index < tempArray.length;index++){
		doTheThing(parseInt(tempArray[index],8) + 01000);
		if(index == cursorPosition-1){
			drawGlyph("0336,0333,0336,0330,0341,0331,0337,0333,0337");
		}
	}
}

function byteCode2string(localByteCode){
	var localString = "";
	var stringArray = localByteCode.split(",");
	for(var index = 0;index < stringArray.length;index++){
		var myCharCode = String.fromCharCode(parseInt(stringArray[index],8));
		if(parseInt(stringArray[index],8) >= 040 && parseInt(stringArray[index],8) < 0177 ){
			localString += myCharCode;
		}
		if(parseInt(stringArray[index],8) == 012){//newline
			localString += myCharCode;
		}
		if(parseInt(stringArray[index],8) == 011){//vertical tab
			localString += myCharCode;
		}
		
	}
	return localString;
}

function string2byteCode(localString){
	var localByteCode = "";
	for(var stringIndex = 0;stringIndex < localString.length;stringIndex++){
		var tempCharCode = localString.charCodeAt(stringIndex);
		if(tempCharCode != 0){
			localByteCode += "0";
			localByteCode += tempCharCode.toString(8);
			localByteCode += ",";
		}
	}
	return localByteCode;
}
function doTheThing(localCommand){
 
    if(localCommand >= 0040 && localCommand <= 0277){//shapes and fonts
		 drawGlyph(currentTable[localCommand]);    	    
    }
    if(localCommand >= 0400 && localCommand <= 0477){//manuscript glyphs
		 drawGlyph(currentTable[localCommand]);    	    
    }
    if(localCommand >= 01000 && localCommand <= 01377){//symbol glyphs
		 drawGlyph(currentTable[localCommand]);    	    
    }
 
    if(localCommand == 0300){
      x = x0;
      y = y0;
      theta = theta0;
      side = unit;
      thetaStep = Math.PI/2;
      scaleFactor = 2;
      ctx.lineWidth = 2;
      ctx.strokeStyle="black";
      ctx.fillStyle="black";
    }
    if(localCommand == 0304){
      thetaStep = Math.PI/2;
    }
    if(localCommand == 0305){
      thetaStep = 2*Math.PI/5;
    }
    if(localCommand == 0306){
      thetaStep = Math.PI/3;
    }    
    if(localCommand == 0310){
       scaleFactor = Math.sqrt(2); 
    }
    if(localCommand == 0311){
       scaleFactor = phi; //"golden" ratio 
    }
    if(localCommand == 0312){
       scaleFactor = Math.sqrt(3); 
    }
    if(localCommand == 0313){
      scaleFactor = 2;  //2x
    }
    if(localCommand == 0314){
      scaleFactor = 3;  //3x
    }
    if(localCommand == 0315){
      scaleFactor = 3.14159;  //pi*
    }    
    if(localCommand == 0316){
      scaleFactor = 5;  //5*
    }        
    if(localCommand == 0317){
       side = unit; 
    }
    if(localCommand == 0320){
		ctx.strokeStyle="black";
    	ctx.lineWidth = 1;    	
    	ctx.fillStyle = "black";

    }
    if(localCommand == 0321){
		ctx.strokeStyle = "yellow";
    	ctx.lineWidth = 1;    	
    	ctx.fillStyle = "yellow";
    }
    if(localCommand == 0322){
		ctx.strokeStyle="red";
    	ctx.lineWidth = 1;
    	ctx.fillStyle = "red";    
    }
    if(localCommand == 0323){
		ctx.strokeStyle="white";
    	ctx.lineWidth = 1;
    	ctx.fillStyle = "white";    
    }
    
    if(localCommand == 0330){
      x += side*Math.cos(theta);   
      y += side*Math.sin(theta); 
    }
    if(localCommand == 0331){
      x -= side*Math.cos(theta);   
      y -= side*Math.sin(theta); 
    }
    if(localCommand == 0332){
      x += side*Math.cos(theta - thetaStep);
      y += side*Math.sin(theta - thetaStep);
    }
    if(localCommand == 0333){
      x += side*Math.cos(theta + thetaStep);
      y += side*Math.sin(theta + thetaStep);
    }
    if(localCommand == 0334){
      theta -= thetaStep; // CCW
    }
    if(localCommand == 0335){
      theta += thetaStep; // CW
    }
    if(localCommand == 0336){
      side /= scaleFactor; // -
    }
    if(localCommand == 0337){
      side *= scaleFactor; // +
    }
    if(localCommand == 0340){  //point
		ctx.beginPath();
		ctx.arc(x, y, 3, 0, 2 * Math.PI);
		ctx.fill();	
		ctx.closePath();

    }
    if(localCommand == 0341){  //circle
		ctx.beginPath();
		ctx.arc(x, y, side, 0, 2 * Math.PI);
		ctx.closePath();
		ctx.stroke();
    }
    if(localCommand == 0342){   //line
    	ctx.beginPath();
    	ctx.moveTo(x,y);
		ctx.lineTo(x + side*Math.cos(theta),y + side*Math.sin(theta));
		ctx.stroke();		
   		ctx.closePath();

    }
    if(localCommand == 0343){
    	ctx.beginPath();
		ctx.arc(x, y, side, theta - thetaStep,theta + thetaStep);
		ctx.stroke();
		ctx.closePath();

    }
    if(localCommand == 0344){   //line
		ctx.lineTo(x + side*Math.cos(theta),y + side*Math.sin(theta));
		ctx.stroke();		
    }
    if(localCommand == 0345){
		ctx.arc(x, y, side, theta - thetaStep,theta + thetaStep);
		ctx.stroke();
    }



    if(localCommand == 0350){
      thetaStep /= 2;  //angle/2
    }
    if(localCommand == 0351){
      thetaStep *= 2;  //2angle
    }
    if(localCommand == 0352){
      thetaStep /= 3; //angle/3
    }
    if(localCommand == 0353){
      thetaStep *= 3; //3angle
    }

    if(localCommand == 0362){
	   ctx.beginPath();
	   ctx.moveTo(x,y);
    }
    if(localCommand == 0363){
	   ctx.closePath();
	   ctx.fill();		
    }

}

function localRoot(localCommand){//010 octal  = 8 decimal = delete as per ASCII spec
//	localCommand = parseInt(localCommand,8);

	if(localCommand == 010){
		currentGlyphArray = currentGlyph.split(",");
		
		firstHalf = "";
		secondHalf = "";	
		for(var index = 0;index < cursorPosition - 1;index++){
			firstHalf += currentGlyphArray[index] + ",";
		}
		for(var index = cursorPosition;index < currentGlyphArray.length;index++){
			secondHalf += currentGlyphArray[index] + ",";
		}				
		currentGlyph = firstHalf + secondHalf;
		console.log(currentGlyph);
		if(cursorPosition > 0){
			cursorPosition--;
		}
		currentGlyph = commaCleaner(currentGlyph);

		redraw();
	}

	if(localCommand == 0020){//cursor forward
		cursorPosition--;
		if(cursorPosition < 0){
			cursorPosition = currentGlyphArray.length;			
		}

		redraw();
	}
	if(localCommand == 0021){//cursor back
		cursorPosition++;
		if(cursorPosition > currentGlyphArray.length ){
			cursorPosition = 0;
		}
		redraw();
	}	
	if(localCommand == 0022){//move to previous glyph in table
		currentGlyph = document.getElementById("glyphBytecode").value;
		currentGlyph = commaCleaner(currentGlyph);
		currentTable[currentAddress] = currentGlyph;
		currentAddress--;
		currentGlyph = currentTable[currentAddress];
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();
	}
	if(localCommand == 0023){//move to next glyph in table
		currentGlyph = document.getElementById("glyphBytecode").value;
		currentGlyph = commaCleaner(currentGlyph);
		currentTable[currentAddress] = currentGlyph;
		currentAddress++;
		currentGlyph = currentTable[currentAddress];
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();

	}	
	if(localCommand == 0024){//from action to symbol
		if(currentAddress < 01000 && currentAddress > 0){
			currentAddress += 01000;
			currentGlyph = currentTable[currentAddress];

		}
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();

	}	
	if(localCommand == 0025){//from symbol to action
		if(currentAddress > 01000 && currentAddress < 02000){
			currentAddress -= 01000;
			currentGlyph = currentTable[currentAddress];
		}
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();
	}
	
	if(localCommand == 0026){//import full geometron hypercube
		var localString = document.getElementById("mainTextArea").value;
		var inputStack = localString.split("\n");
		for(var index = 0;index < inputStack.length;index++){
			var stackLine = inputStack[index].split(":");
			var localAddress = parseInt(stackLine[0],8);
			var localGlyph = stackLine[1];
			currentTable[localAddress] = localGlyph;
		}
		currentGlyph = currentTable[currentAddress];
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();

	}
	if(localCommand == 0027){//export full geometron hypercube
		var localString = "";
		for(var index = 0;index < currentTable.length;index++){
			localString += "0" + index.toString(8) + ":" + currentTable[index] + "\n";
		}
		document.getElementById("mainTextArea").value = localString;
	}
	if(localCommand == 030){
		if(document.getElementById("glyphTableEditor").style.display != "none"){
			document.getElementById("glyphTableEditor").style.display = "none";
		}else{
			document.getElementById("glyphTableEditor").style.display = "block";
		}
	}
}
</script>
<div class = "atom">
<h1>Geometron Instance Construction</h1>
Start with a simple demonstration of a filled square:
<p>
<canvas width = "600" height = "300" id = "glyph1"></canvas>
<script>
ctx = document.getElementById("glyph1").getContext("2d");
x0 = 300;
y0 = 150;
unit = 100;
doTheThing(0300);
doTheThing(0211);

x0 = 30;
y0 = 250;
unit = 25;
doTheThing(0300);
spellGlyph(currentTable[0211]);

</script>
<p>
The first thing to do with this is construct the capacitor pads for the 0603 size SMT capacitors.  Then I'll build the pads for the flip chip SQUID chips, the launch pads for the SMAs, some vias, transmission line(microstrip)
</div>
<div class = "atom">
	<img src = "https://i.imgur.com/bCo9scu.png"></img>
</div>
<div class = "atom" style = "overflow:scroll;width:600px">
First I just want an 8x8 square pad where 1 unit = 1 mm.  I also want it symmetric.  
<p>
<canvas width = "1600" height = "300" id = "glyph2"></canvas>
<script>
ctx = document.getElementById("glyph2").getContext("2d");
x0 = 300;
y0 = 150;
unit = 100;
doTheThing(0300);
doTheThing(0401);

x0 = 30;
y0 = 250;
unit = 25;
doTheThing(0300);
spellGlyph(currentTable[0220]);

</script>
<p>
</div>
<div class = "atom">
I now cut right to the finished product, a 0603 surface mount pad, now based on a unit of 1 mm 
<canvas width = "600" height = "300" id = "glyph3"></canvas>
<script>
ctx = document.getElementById("glyph3").getContext("2d");
x0 = 300;
y0 = 150;
unit = 100;
doTheThing(0300);
drawGlyph("0331,0335,0336,0330,0330,0334,0332,0332,0332,0330,0222,");
</script>
</div>

<div class = "atom">
Everything in this file is based on one command, the line-in-close-figure command, or 0344 in octal code:
<p>
<canvas width = "200" height = "200" id = "glyph4"></canvas>
<script>
ctx = document.getElementById("glyph4").getContext("2d");
x0 = 50;
y0 = 150;
unit = 100;
doTheThing(0300);
drawGlyph("0300,01344");
</script>
<pre style = "border:solid;padding: 5px 5px 5px 5px">

function doTheThing(localCommand){
...
    if(localCommand == 0344){   //line
		ctx.lineTo(x + side*Math.cos(theta),y + side*Math.sin(theta));
		ctx.stroke();		
    }
...

}
</pre>
This is of note because it is different from the line used for line drawings without fill or for things other than fabrication layout, which looks like this:
<pre style = "border:solid;padding: 5px 5px 5px 5px">

function doTheThing(localCommand){
...
    if(localCommand == 0342){   //line
    	ctx.beginPath();
    	ctx.moveTo(x,y);
		ctx.lineTo(x + side*Math.cos(theta),y + side*Math.sin(theta));
		ctx.stroke();		
   		ctx.closePath();
    }
...
}
</pre>
  The distinction is important, since if you close the path when you don't want to it breaks the filled polygon that we need for fabrication layout, but if you fail to close the path when you mean to just make a discrete line segment you get a huge mess, which must be avoided.  We need both even though this is all about filled polygons because the symbol glyphs and some font glyphs need the discrete line segments.  
</div>

<div class = "atom">
Now I want to look at some shapes in order.
<p>
<canvas width = "600" height = "150" id = "glyph5"></canvas>
<script>
ctx = document.getElementById("glyph5").getContext("2d");
x0 = 40;
y0 = 50;
unit = 50;
doTheThing(0300);
drawGlyph("0300,01202,072,0331,0332,0332,0336");
spellGlyph(currentTable[0202]);
</script>
<p>
<canvas width = "600" height = "150" id = "glyph6"></canvas>
<script>
ctx = document.getElementById("glyph6").getContext("2d");
x0 = 40;
y0 = 50;
unit = 50;
doTheThing(0300);
drawGlyph("0300,01203,072,0331,0332,0332,0336");
spellGlyph(currentTable[0203]);
</script>
<p>
<canvas width = "600" height = "150" id = "glyph7"></canvas>
<script>
ctx = document.getElementById("glyph7").getContext("2d");
x0 = 40;
y0 = 50;
unit = 50;
doTheThing(0300);
drawGlyph("0300,01204,072,0331,0332,0332,0336");
spellGlyph(currentTable[0204]);
</script>
<p>
<canvas width = "600" height = "150" id = "glyph8"></canvas>
<script>
ctx = document.getElementById("glyph8").getContext("2d");
x0 = 40;
y0 = 50;
unit = 50;
doTheThing(0300);
drawGlyph("0300,01205,072,0331,0332,0332,0336");
spellGlyph(currentTable[0205]);
</script>

</div>

<style>

html {
	height: 100%;
	background: black;
	background-size: cover;
}

.atom{
	width: auto;
	height: auto;
	border-style: solid;
	border-width: 6px;
	border-color: purple;
	border-radius: 25px;
	padding: 10px 10px 10px 10px;
	margin: 10px 10px 10px 10px;
	background: white;	
	font-size: 14px;
	font-family: "Century Schoolbook";
	text-align: left;
	float:left;
}
#spellDiv{
	width: 600px;
	height: auto;
	border-style: solid;
	border-width: 6px;
	border-color: purple;
	border-radius: 25px;
	padding: 15px 15px 15px 15px;
	margin: 10px 10px 10px 10px;
	background: white;	
	float:left;
	overflow: scroll;
}

#plotCanvas{
	border-style: solid;
	border-width: 1px;
	border-color: black;
	border-radius: 5px;

}
.glyphButtons{
    border-style: solid;
    border-width: 0px;
    border-color: black;
    background: white;	
}
.glyphButtons:hover{
    background: gray;	

}
.glyphButtons:active{
    background: yellow;	
}
#glyphTableEditor{
	background: gray;	
}

</style>
</center>
</body>
</html>