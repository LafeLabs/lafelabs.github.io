<!DOCTYPE html>
<html>
<head>
<title>MathJax Dynamic Math Test Page</title>
<script src="libraries/geometron2library.js">
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
initGeometron();
canvasIndex = 0;
</script>
</head>
<body>

<div id = "canvases">
</div>

<script>


	currentText = "<h2>Title</h2>"
	rootMagic(03);
	currentText = "Some text, $$E = mc^2$$"
	rootMagic(03);
	currentGlyph = "0300,0331,0336,0214,0211,0210,"
	wordStack = [];
	wordStack.push("Some text, $$E = mc^2$$");
	rootMagic(01);
	MathJax.Hub.Typeset();//tell Mathjax to update the math

function rootMagic(localCommand){//plain geoemetron
	if(localCommand == 0001){
		slideWidth = 6*unit;

		var newCanvas = document.createElement("CANVAS");
		newCanvas.setAttribute("width", slideWidth.toString());
		newCanvas.setAttribute("height", slideHeight.toString());
		newCanvas.setAttribute("style", "border:1px solid;");
		var canvasName = "canvas" + canvasIndex.toString();
		newCanvas.setAttribute("id",canvasName);
		var divName = "div" + canvasIndex.toString();
		var newDiv  = document.createElement("DIV");
		newDiv.setAttribute("id",divName);
		newDiv.appendChild(newCanvas);      						
		var canvasesDiv = document.getElementById("canvases");
		canvasesDiv.insertBefore(newDiv, canvasesDiv.childNodes[0]);   
		//assumes currentGlyph set somewhere
		ctx = document.getElementById("canvas" + canvasIndex.toString()).getContext("2d");
		drawGlyph(currentGlyph);
		canvasIndex++;
	}
	
	if(localCommand == 0002){ //geoemetron on top of an image 
		var img = new Image();		
		
		img.onload = function() {
			slideWidth = 6*unit*(2*img.width/(3*img.height));//height fixed, img determines aspect ratio
			var newCanvas = document.createElement("CANVAS");
			newCanvas.setAttribute("width", slideWidth.toString());
			newCanvas.setAttribute("height", slideHeight.toString());
			newCanvas.setAttribute("style", "border:1px solid;");
			var canvasName = "canvas" + canvasIndex.toString();
			newCanvas.setAttribute("id",canvasName);
			var divName = "div" + canvasIndex.toString();
			var newDiv  = document.createElement("DIV");
			newDiv.setAttribute("id",divName);
			newDiv.appendChild(newCanvas);      						
			var canvasesDiv = document.getElementById("canvases");
			canvasesDiv.insertBefore(newDiv, canvasesDiv.childNodes[0]);   
			//assumes currentGlyph set somewhere
			ctx = document.getElementById("canvas" + canvasIndex.toString()).getContext("2d");
			ctx.drawImage(img,0,0,img.width,img.height,0,0,slideWidth,slideHeight);	
			x0 = slideWidth/2;
			drawGlyph(currentGlyph);
			x0 = 3*unit;
		};	
	img.src = currentImageURL;	
	canvasIndex++;	
	}
	
	if(localCommand == 003){//text, including mathjax
		var divName = "div" + canvasIndex.toString();
		var newDiv  = document.createElement("DIV");
		newDiv.setAttribute("id",divName);
		newDiv.innerHTML = currentText;//set currentText elsewhere      						
		var canvasesDiv = document.getElementById("canvases");
		canvasesDiv.insertBefore(newDiv, canvasesDiv.childNodes[0]);   
		MathJax.Hub.Typeset();//tell Mathjax to update the math
		canvasIndex++;
	}
	
	if(localCommand == 004){
		
			
	}
		
}


</script>
</body>
</html>

