<!DOCTYPE html>
<html>
<head>
<title>Geometron Panels</title>
<script src="libraries/geometronLibrary3.js">
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>

initGeometron();
loadTable();

for(var addr = 040;addr < 0176;addr++){
	currentTable[addr + 01000] = currentTable[addr];
}

	
canvasIndex = 0;


buttonArray1 = [0334,0330,0335,0332,0300,0333,0336,0331,0337];

//16 element shape table:
buttonArray2 = [0340,0201,0210,0211,0214,0207,0212,0217,0215,0225,0223,0216,0220,0222,0224,0221];

buttonArray3 = [0304,0305,0306,0310,0311,0312,0313,0314,0350,0351,0352,0353];

buttonArray4 = [0020,0021,0022,0024,0025,0023,0010,0026,0027,0030,0016];

</script>
</head>
<body>

<div id = "mainPanel">
	
	<div class = "scalePanel">
		<div id = "scalePanel">
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[0]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[1]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[2]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[3]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[4]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[5]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[6]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[7]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[8]);" width = "60" height = "60">
				</canvas>		
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[9]);" width = "60" height = "60">
				</canvas>		
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[10]);" width = "60" height = "60">
				</canvas>		
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray3[11]);" width = "60" height = "60">
				</canvas>		
					

		</div>
	</div>
	<div class = "subPanels">
		<div id = "movementPanel">
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[0]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[1]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[2]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[3]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[4]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[5]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[6]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[7]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray1[8]);" width = "60" height = "60">
				</canvas>		
				
		</div>
	</div>
	
	<canvas width = "600" height = "400" class = "drawPanel" id = "drawCanvas">
	</canvas>
	<div id = "htmlPanel">
		<h3>Heading</h3>
		<p>
		Some text.
		<p>
		Some more
		<p>
		$$E = mc^2$$
		
		
	</div>
	<div class = "shapePanel">
		<div id = "shapePanelInner">
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[0]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[1]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[2]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[3]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[4]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[5]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[6]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[7]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[8]);" width = "60" height = "60">
				</canvas>		

				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[9]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[10]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[11]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[12]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[13]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[14]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "buttonAction(buttonArray2[15]);" width = "60" height = "60">
				</canvas>
		</div>
	</div>
		
	<div class = "rootPanel">
		<div id = "rootPanel">
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[0]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[1]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[2]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[3]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[4]);" width = "60" height = "60">
				</canvas>
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[5]);" width = "60" height = "60">
				</canvas>						
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[6]);" width = "60" height = "60">
				</canvas>						
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[7]);" width = "60" height = "60">
				</canvas>						
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[8]);" width = "60" height = "60">
				</canvas>						
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[9]);" width = "60" height = "60">
				</canvas>						
				<canvas class = "glyphButtons" onClick = "localRoot(buttonArray4[10]);" width = "60" height = "60">
				</canvas>						
				
		</div>
	</div>
		
	<canvas width = "600" height = "105" class = "spellPanel" id = "spellPanel">
	</canvas>
	<textarea rows = "3" cols = "80" id = "textPanel"> 
	</textarea>
</div>

<style>
html {
	height: 100%;
	background: black;
	background-size: cover;
}

#mainPanel{
	width: 1260px;
	height: 640px;
    border-style: solid;
    border-width: 3px;
    border-color: white;
	margin: 5px 5px;
	padding: 10px 10px 10px 10px;	 
    border-radius: 20px;
	background: black;
	
}

.subPanels div{
    border-color: green;
	width: 230px;
	height: 230px;
    border-style: solid;
    border-width: 2px;
	background: green;
	margin: 10px 10px 10px 10px;
	padding: 10px 10px 10px 10px;
	float: left;
	float: top;
	border-radius: 10px;
}

.shapePanel div{
    border-color: blue;
	width: 310px;
	height: 310px;
    border-style: solid;
    border-width: 2px;
	background: blue;
	margin: 10px 10px 10px 10px;
	padding: 10px 10px 10px 10px;
	float: left;
	float: bottom;
	border-radius: 10px;
}

.scalePanel div{
    border-color: red;
	width: 310px;
	height: 230px;
    border-style: solid;
    border-width: 2px;
	background: red;
	margin: 10px 10px 10px 10px;
	padding: 10px 10px 10px 10px;
	float: left;
	float: top;
	border-radius: 10px;
}

.drawPanel{
    border-color: white;
    border-style: solid;
    border-width: 2px;
	background: white;
	margin: 10px 10px 10px 10px;
	float: top;
	float: right;
	border-radius: 10px;
	
}

#drawCanvas{

}
#htmlPanel{
	width:580px;
	height:380px;
	border-color: white;
    border-style: solid;
    border-width: 2px;
	background: white;
	margin: 10px 10px 10px 10px;
	padding: 10px 10px 10px 10px;

	float: top;
	float: right;
	border-radius: 10px;
	display:none;

}

.spellPanel{
    border-color: white;
    border-style: solid;
    border-width: 2px;
	background: white;
	margin: 10px 10px 10px 10px;
	float: bottom;
	float: right;
	border-radius: 10px;
}

.rootPanel{
	width: 230px;
	height: 310px;
    border-color: purple;
    border-style: solid;
    border-width: 2px;
	background: purple;
	margin: 10px 10px 10px 10px;
	padding: 10px 10px 10px 10px;

	float: left;
	float: bottom;

	border-radius: 10px;
}

.glyphButtons{	
	margin: 5px 5px 5px 5px;
	border-style: solid;
	border-width: 2px;
	border-color: green;
	background: white;
}

.glyphButtons:hover{
	background: grey;
	color: grey;
}

.glyphButtons:active{
    background-color: yellow;
}

#textPanel{
		width: 600px;
		height: 50px;
		margin: 10px 10px 10px 15px;
		border-radius: 10px;
  font-family: courier, fixed, system;




}

</style>


<script>

	MathJax.Hub.Typeset();//tell Mathjax to update the math

	currentAddress = 0206;
	currentGlyph = currentTable[currentAddress];
	currentGlyphArray = currentGlyph.split(",");
	cursorPosition = currentGlyphArray.length;
	redraw();
			
function buttonAction(buttonCommand){

	firstHalf += "0" + buttonCommand.toString(8) + ",";
	currentGlyph = firstHalf + secondHalf;
	cursorPosition++;	
	redraw();

}

	
function redraw(){

	document.getElementById("textPanel").value = "0" + currentAddress.toString(8) +":"+ currentGlyph;

	currentGlyphArray = currentGlyph.split(",");
	firstHalf = "";
	secondHalf = "";	
	for(var index = 0;index < cursorPosition;index++){
		firstHalf += currentGlyphArray[index] + ",";
	}
	for(var index = cursorPosition;index < currentGlyphArray.length;index++){
		secondHalf += currentGlyphArray[index] + ",";
	}


	ctx = document.getElementById("drawCanvas").getContext("2d");	
	ctx.clearRect(0, 0, slideWidth, slideHeight);
	doTheThing(0300);	
	drawGlyph(firstHalf);	drawGlyph("0342,0334,0342,0335,0335,0342,0334,0337,0330,0340,0331,0336,0336,0330,0340,0331,0337");//cursor
	drawGlyph(secondHalf);	

	var tempSide = side;
	ctx = document.getElementById("spellPanel").getContext("2d");		
	ctx.clearRect(0, 0, 600, 200);
	doTheThing(0300);			
	x = 10;
	y = 35;
	side = 30;

	firstHalfArray = firstHalf.split(",");
	for(var index = 0;index < firstHalfArray.length;index++){
		doTheThing(01000 + parseInt(firstHalfArray[index],8));
		if(x > 560){
			x = 10;
			y += 32;
		}	
		if(y > 110){
			break;
		}
	}
drawGlyph("0333,0336,0330,0332,0336,0336,0341,0337,0342,0335,0335,0342,0340,0335,0335,0335,0334,0331,0331,0333,0333,0337,0337");

	secondHalfArray = secondHalf.split(",");
	for(var index = 0;index < secondHalfArray.length;index++){
		doTheThing(01000 + parseInt(secondHalfArray[index],8));
		if(x > 560){
			x = 10;
			y += 32;
		}	
		if(y > 110){
			break;
		}

	}

	side = tempSide;	
	currentTable[currentAddress] = currentGlyph;
}
	
	
	
function localRoot(localCommand){

	if(localCommand == 0010){
			currentGlyphArray = currentGlyph.split(",");
			firstHalf = "";
			secondHalf = "";	
			for(var index = 0;index < cursorPosition - 1;index++){
				firstHalf += currentGlyphArray[index] + ",";
			}
			for(var index = cursorPosition;index < currentGlyphArray.length;index++){
				secondHalf += currentGlyphArray[index] + ",";
			}		
			
			currentGlyph = firstHalf + secondHalf;
		cursorPosition--;
		redraw();
	}
	
	if(localCommand == 0012){
		//reserve this for "\n" newline
		drawGlyph("0331,0332,0332,0332,0332,0332,0332,0332,0332,");
	}
	
	if(localCommand == 016){//import words
		var localString = document.getElementById("textPanel").value;
		currentWord = localString;
		currentGlyph = "0332,0332,0336,0336,0336," + string2byteCode(localString);
		currentTable[currentAddress] = currentGlyph;
		redraw();		
	}	
	if(localCommand == 0020){
		cursorPosition--;
		if(cursorPosition < 0){
			cursorPosition = currentGlyphArray.length;
			
		}
		redraw();
	}
	if(localCommand == 0021){
		cursorPosition++;
		if(cursorPosition > currentGlyphArray.length - 1){
			cursorPosition = 0;
		}
		redraw();
	}	
	if(localCommand == 0022){
		currentAddress--;
		currentGlyph = currentTable[currentAddress];
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();
	}
	if(localCommand == 0023){
		currentAddress++;
		currentGlyph = currentTable[currentAddress];
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();

	}	
	if(localCommand == 0024){
		if(currentAddress < 01000 && currentAddress > 0){
			currentAddress += 01000;
			currentGlyph = currentTable[currentAddress];

		}
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();

	}	
	if(localCommand == 0025){
		if(currentAddress > 01000 && currentAddress < 02000){
			currentAddress -= 01000;
			currentGlyph = currentTable[currentAddress];
		}
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();
	}
	if(localCommand == 0026){//import full geometron hypercube
		var localString = document.getElementById("textPanel").value;
		var inputStack = localString.split("\n");
		for(var index = 0;index < inputStack.length;index++){
			var stackLine = inputStack[index].split(":");
			var localAddress = parseInt(stackLine[0],8);
			var localGlyph = stackLine[1];
			currentTable[localAddress] = localGlyph;
		}
		currentGlyph = currentTable[currentAddress];
		currentGlyphArray = currentGlyph.split(",");
		cursorPosition = currentGlyphArray.length;
		redraw();

	}
	if(localCommand == 0027){//export full geometron hypercube
		var localString = "";
		for(var index = 0;index < currentTable.length;index++){
			localString += "0" + index.toString(8) + ":" + currentTable[index] + "\n";
		}
		document.getElementById("textPanel").value = localString;
	}
	if(localCommand == 0030){//shape table assignment
		var localString = document.getElementById("textPanel").value;
		var stringArray = localString.split(",");
		for(var index = 0;index < stringArray.length;index++){
			buttonArray2.pop();
		}
		for(var index = 0;index < stringArray.length;index++){
			buttonArray2.push(parseInt(stringArray[index],8));
		}
		console.log(buttonArray2);
		panelArray2 = document.getElementById("shapePanelInner").children;
		for(var index = 0;index < panelArray2.length;index++){
			if(buttonArray2[index] != undefined){
				ctx = panelArray2[index].getContext("2d");
				ctx.clearRect(0, 0, 60, 60);		
				drawGlyph("0300");
				x=-2;
				y=62;
				side = 64;
				drawGlyph("01"+buttonArray2[index].toString(8));
			}
		}

	
		
	}

}
	

panelArray1 = document.getElementById("movementPanel").children;

for(var index = 0;index < panelArray1.length;index++){
	ctx = panelArray1[index].getContext("2d");
	drawGlyph("0300");
	x=-2;
	y=62;
	side = 64;

	drawGlyph("01"+buttonArray1[index].toString(8));
	
	
}

panelArray2 = document.getElementById("shapePanelInner").children;
for(var index = 0;index < panelArray2.length;index++){
	if(buttonArray2[index] != undefined){
		ctx = panelArray2[index].getContext("2d");
		drawGlyph("0300");
		x=-2;
		y=62;
		side = 64;
		drawGlyph("01"+buttonArray2[index].toString(8));
	}
}

panelArray3 = document.getElementById("scalePanel").children;
for(var index = 0;index < panelArray3.length;index++){
	if(buttonArray3[index] != undefined){
		ctx = panelArray3[index].getContext("2d");
		drawGlyph("0300");
		x=-2;
		y=62;
		side = 64;
		drawGlyph("01"+buttonArray3[index].toString(8));
	}
}


panelArray4 = document.getElementById("rootPanel").children;
for(var index = 0;index < panelArray4.length;index++){
	if(buttonArray4[index] != undefined){
		ctx = panelArray4[index].getContext("2d");
		drawGlyph("0300");
		x=-2;
		y=62;
		side = 64;
		doTheThing(01000 + buttonArray4[index]);
		//drawGlyph("010"+buttonArray4[index].toString(8));
	}
}

</script>
</body>
</html>

